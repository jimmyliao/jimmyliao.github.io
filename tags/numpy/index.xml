<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom"><channel><title>Numpy on JimmyLiao Notes</title><link>https://jimmyliao.net/tags/numpy/</link><description>Recent content in Numpy on JimmyLiao Notes</description><generator>Hugo -- gohugo.io</generator><copyright>Copyright © 2008–2018, Steve Francia and the Hugo Authors; all rights reserved.</copyright><lastBuildDate>Tue, 10 Jan 2023 00:18:36 +0800</lastBuildDate><atom:link href="https://jimmyliao.net/tags/numpy/index.xml" rel="self" type="application/rss+xml"/><item><title>How to resolve numpy deprecation issue: AttributeError: module 'numpy' has no attribute 'str'. Did you mean: 'std'?</title><link>https://jimmyliao.net/post/2023-01-10-numpy/</link><pubDate>Tue, 10 Jan 2023 00:18:36 +0800</pubDate><guid>https://jimmyliao.net/post/2023-01-10-numpy/</guid><description>
&lt;p>最近準備 Model Training Code 的時候, 發現幾個禮拜前的 Code 居然 Failed. 才發現一直沒仔細看 Warninig message.&lt;/p>
&lt;p>FutureWarning: In the future &lt;code>np.str&lt;/code> will be defined as the corresponding NumPy scalar. (This may have returned Python scalars in past versions.&lt;/p>
&lt;ol>
&lt;li>
&lt;p>之前的版本&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">$ pip show numpy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl">Name: numpy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">Version: 1.23.5
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl">Summary: NumPy is the fundamental package &lt;span class="k">for&lt;/span> array computing with Python.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl">Home-page: https://www.numpy.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl">Author: Travis E. Oliphant et al.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl">Author-email:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl">License: BSD
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl">Location: /home/jimmyliao/venvs/mlops/lib/python3.10/site-packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">10&lt;/span>&lt;span class="cl">Requires:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">11&lt;/span>&lt;span class="cl">Required-by: contourpy, matplotlib, mlflow, numba, pandas, pyarrow, scikit-learn, scipy, shap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>原來, 一直都有提示即將被 deprecated.&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">$ python train_iris.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl">train_iris.py:28: DeprecationWarning: &lt;span class="sb">`&lt;/span>np.str&lt;span class="sb">`&lt;/span> is a deprecated &lt;span class="nb">alias&lt;/span> &lt;span class="k">for&lt;/span> the &lt;span class="nb">builtin&lt;/span> &lt;span class="sb">`&lt;/span>str&lt;span class="sb">`&lt;/span>. To silence this warning, use &lt;span class="sb">`&lt;/span>str&lt;span class="sb">`&lt;/span> by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use &lt;span class="sb">`&lt;/span>np.str_&lt;span class="sb">`&lt;/span> here.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">Deprecated in NumPy 1.20&lt;span class="p">;&lt;/span> &lt;span class="k">for&lt;/span> more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl"> run.log&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Kernel type&amp;#39;&lt;/span>, np.str&lt;span class="o">(&lt;/span>args.kernel&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl">Attempted to log scalar metric Kernel type:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl">linear
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl">/home/jimmyliao/workspace/lab/train_iris.py:29: DeprecationWarning: &lt;span class="sb">`&lt;/span>np.float&lt;span class="sb">`&lt;/span> is a deprecated &lt;span class="nb">alias&lt;/span> &lt;span class="k">for&lt;/span> the &lt;span class="nb">builtin&lt;/span> &lt;span class="sb">`&lt;/span>float&lt;span class="sb">`&lt;/span>. To silence this warning, use &lt;span class="sb">`&lt;/span>float&lt;span class="sb">`&lt;/span> by itself. Doing this will not modify any behavior and is safe. If you specifically wanted the numpy scalar type, use &lt;span class="sb">`&lt;/span>np.float64&lt;span class="sb">`&lt;/span> here.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl">Deprecated in NumPy 1.20&lt;span class="p">;&lt;/span> &lt;span class="k">for&lt;/span> more details and guidance: https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl"> run.log&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Penalty&amp;#39;&lt;/span>, np.float&lt;span class="o">(&lt;/span>args.penalty&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">10&lt;/span>&lt;span class="cl">Attempted to log scalar metric Penalty:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">11&lt;/span>&lt;span class="cl">1.0
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>升級到目前的 release: &lt;code>1.24.1&lt;/code>&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">$ pip install -U numpy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl">Successfully installed numpy-1.24.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">&lt;span class="o">(&lt;/span>mlops&lt;span class="o">)&lt;/span> jimmyliao@JimmyLiaoSL:~/workspace/lab$ pip show numpy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl">Name: numpy
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl">Version: 1.24.1
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl">Summary: Fundamental package &lt;span class="k">for&lt;/span> array computing in Python
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl">Home-page: https://www.numpy.org
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl">Author: Travis E. Oliphant et al.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl">Author-email:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">10&lt;/span>&lt;span class="cl">License: BSD-3-Clause
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">11&lt;/span>&lt;span class="cl">Location: /home/jimmyliao/venvs/mlops/lib/python3.10/site-packages
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">12&lt;/span>&lt;span class="cl">Requires:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">13&lt;/span>&lt;span class="cl">Required-by: contourpy, matplotlib, mlflow, numba, pandas, pyarrow, scikit-learn, scipy, shap
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;p>執行就直接噴 Error&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">train_iris.py:28: FutureWarning: In the future &lt;span class="sb">`&lt;/span>np.str&lt;span class="sb">`&lt;/span> will be defined as the corresponding NumPy scalar. &lt;span class="o">(&lt;/span>This may have returned Python scalars in past versions.
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl"> run.log&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Kernel type&amp;#39;&lt;/span>, np.str&lt;span class="o">(&lt;/span>args.kernel&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">Traceback &lt;span class="o">(&lt;/span>most recent call last&lt;span class="o">)&lt;/span>:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/home/jimmyliao/workspace/lab/train_iris.py&amp;#34;&lt;/span>, line 60, in &amp;lt;module&amp;gt;
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl"> main&lt;span class="o">()&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/home/jimmyliao/workspace/lab/train_iris.py&amp;#34;&lt;/span>, line 28, in main
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl"> run.log&lt;span class="o">(&lt;/span>&lt;span class="s1">&amp;#39;Kernel type&amp;#39;&lt;/span>, np.str&lt;span class="o">(&lt;/span>args.kernel&lt;span class="o">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl"> File &lt;span class="s2">&amp;#34;/home/jimmyliao/venvs/mlops/lib/python3.10/site-packages/numpy/__init__.py&amp;#34;&lt;/span>, line 284, in __getattr__
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl"> raise AttributeError&lt;span class="o">(&lt;/span>&lt;span class="s2">&amp;#34;module {!r} has no attribute &amp;#34;&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">10&lt;/span>&lt;span class="cl">AttributeError: module &lt;span class="s1">&amp;#39;numpy&amp;#39;&lt;/span> has no attribute &lt;span class="s1">&amp;#39;str&amp;#39;&lt;/span>. Did you mean: &lt;span class="s1">&amp;#39;std&amp;#39;&lt;/span>?
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;li>
&lt;p>回頭找一下 Numpy 官網, 早就在 1.20 的文件就有說明.&lt;/p>
&lt;p>&lt;a href="https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations">https://numpy.org/devdocs/release/1.20.0-notes.html#deprecations&lt;/a>&lt;/p>
&lt;blockquote>
&lt;p>&lt;code>Using the aliases of builtin types like np.int is deprecated&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;blockquote>
&lt;p>&lt;code>For a long time, np.int has been an alias of the builtin int. This is repeatedly a cause of confusion for newcomers, and existed mainly for historic reasons.&lt;/code>&lt;/p>
&lt;/blockquote>
&lt;p>白話的意思就是 &lt;code>np.int&lt;/code> 通常被拿來當作內建 &lt;code>int&lt;/code> 的 alias, 在之前的版本其實都有 FutureWarning 只是都被忽略.現在要正式 deprecated.&lt;/p>
&lt;p>解決方法就照上面的文件說明, 取代成對應的. 像是:&lt;/p>
&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-python" data-lang="python">&lt;span class="line">&lt;span class="ln">1&lt;/span>&lt;span class="cl">&lt;span class="n">run&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Kernel type&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">str_&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">kernel&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">2&lt;/span>&lt;span class="cl">&lt;span class="n">run&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">log&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="s1">&amp;#39;Penalty&amp;#39;&lt;/span>&lt;span class="p">,&lt;/span> &lt;span class="n">np&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">double&lt;/span>&lt;span class="p">(&lt;/span>&lt;span class="n">args&lt;/span>&lt;span class="o">.&lt;/span>&lt;span class="n">penalty&lt;/span>&lt;span class="p">))&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;div class="highlight">&lt;pre tabindex="0" class="chroma">&lt;code class="language-bash" data-lang="bash">&lt;span class="line">&lt;span class="ln"> 1&lt;/span>&lt;span class="cl">$ python train_iris.py
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 2&lt;/span>&lt;span class="cl">Attempted to log scalar metric Kernel type:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 3&lt;/span>&lt;span class="cl">linear
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 4&lt;/span>&lt;span class="cl">Attempted to log scalar metric Penalty:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 5&lt;/span>&lt;span class="cl">1.0
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 6&lt;/span>&lt;span class="cl">Accuracy of SVM classifier on &lt;span class="nb">test&lt;/span> set: 0.97
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 7&lt;/span>&lt;span class="cl">Attempted to log scalar metric Accuracy:
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 8&lt;/span>&lt;span class="cl">0.9736842105263158
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln"> 9&lt;/span>&lt;span class="cl">&lt;span class="o">[[&lt;/span>&lt;span class="m">13&lt;/span> &lt;span class="m">0&lt;/span> 0&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">10&lt;/span>&lt;span class="cl">&lt;span class="o">[&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">15&lt;/span> 1&lt;span class="o">]&lt;/span>
&lt;/span>&lt;/span>&lt;span class="line">&lt;span class="ln">11&lt;/span>&lt;span class="cl">&lt;span class="o">[&lt;/span> &lt;span class="m">0&lt;/span> &lt;span class="m">0&lt;/span> 9&lt;span class="o">]]&lt;/span>
&lt;/span>&lt;/span>&lt;/code>&lt;/pre>&lt;/div>&lt;/li>
&lt;/ol>
&lt;p>收工.&lt;/p></description></item></channel></rss>