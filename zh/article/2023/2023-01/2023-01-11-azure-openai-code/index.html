<!doctype html><html itemscope itemtype=https://schema.org/WebPage class=no-js lang=zh><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=siteBaseUrl content="https://jimmyliao.net"><meta name=author content="JimmyLiao"><meta name=description content="JimmyLiao Notes Blog"><meta name=keywords content="jimmyliao,personal,runner,fullstack,cloud,mobile,architect"><meta name=generator content="Hugo 0.114.0"><title>Azure OpenAI Part 2: Show me the code! | JimmyLiao</title><meta itemprop=name content="Azure OpenAI Part 2: Show me the code!"><meta itemprop=description content="Azure OpenAI Part 2: Show me the code!"><meta property="og:site_name" content="JimmyLiao"><meta property="og:title" content="Azure OpenAI Part 2: Show me the code!"><meta property="og:description" content="Azure OpenAI Part 2: Show me the code!"><meta property="og:type" content="article"><meta property="og:url" content="https://jimmyliao.net/zh/article/2023/2023-01/2023-01-11-azure-openai-code/"><meta property="article:section" content="article"><meta property="article:published_time" content="2023-01-11T02:18:36+08:00"><meta property="article:modified_time" content="2023-01-11T02:18:36+08:00"><script src=/modernizr-simple.js></script>
<link href=/zh/article/2023/2023-01/2023-01-11-azure-openai-code/ rel=alternate type=application/rss+xml title=JimmyLiao><link href=/zh/article/2023/2023-01/2023-01-11-azure-openai-code/ rel=feed type=application/rss+xml title=JimmyLiao><link rel=canonical href=https://jimmyliao.net/zh/article/2023/2023-01/2023-01-11-azure-openai-code/><link rel=stylesheet href=https://jimmyliao.net/theme.css></head><body class=bilberry-hugo-theme><nav><div class=container><ul class=topnav></ul><div id=search-box class=search><i class="fas fa-search"></i>
<input id=search type=text placeholder="Search ..."></div></div></nav><header><div class=container><div class=logo><a href=/zh class=logo><img src=/images/fb_share.jpg alt>
<span class=overlay><i class="fa fa-home"></i></span></a></div><div class=titles><h3 class=title><a href=/zh>JimmyLiao</a></h3><span class=subtitle>Hello World! This is the most epic subtitle ever.</span></div><div class=languages><a href=/>en</a>
<a href=/zh/article/2023/2023-01/2023-01-11-azure-openai-code/ class=active>zh</a></div><div class=toggler><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=https://jimmyliao.net/zh/article/2023/2023-01/2023-01-11-azure-openai-code/><i class="fas fa-fw fa-pencil-alt"></i></a><article class="default article"><div class=content><h1 class=article-title><a href=https://jimmyliao.net/zh/article/2023/2023-01/2023-01-11-azure-openai-code/>Azure OpenAI Part 2: Show me the code!</a></h1><div class=meta><span class="date moment">2023-01-11</span>
<span class=categories><a href=https://jimmyliao.net/zh/categories/azure/>Azure</a>
<a href=https://jimmyliao.net/zh/categories/openai/>OpenAI</a></span></div><p><a href=https://jimmyliao.net/post/2023-01-11-azure-openai/>前一篇</a> 介紹了申請以及使用 Azure OpenAI Studio (<a href=https://oai.azure.com/portal>https://oai.azure.com/portal</a>) 快速部署 Model 以及驗證. 這篇介紹如何使用 Python Code 整合進原本的應用程式.</p><ol><li><p>在前一篇最後, 利用 Playground 測試 OpenAI 時, 不知道有沒有發現右上方有 <code>Code View</code> 這個按鈕?<br><img src=/images/2023/2023-01/2023-01-11/08.png alt></p></li><li><p>比對一下 Azure OpenAI 和 OpenAI 的範例.</p><ul><li><p>Azure OpenAI 的範例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> openai
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;azure&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_base <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://&lt;YOUR-ENDPOINT-NAME&gt;.openai.azure.com/&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&lt;OPENAI-API-VERSION&gt;&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> openai<span style=color:#f92672>.</span>Completion<span style=color:#f92672>.</span>create(
</span></span><span style=display:flex><span>  engine<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&lt;MODEL-NAME&gt;&#34;</span>,
</span></span><span style=display:flex><span>  prompt<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span>
</span></span><span style=display:flex><span>  temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>0.7</span>,
</span></span><span style=display:flex><span>  max_tokens<span style=color:#f92672>=</span><span style=color:#ae81ff>60</span>,
</span></span><span style=display:flex><span>  top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>  frequency_penalty<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  presence_penalty<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  stop<span style=color:#f92672>=</span><span style=color:#66d9ef>None</span>)    
</span></span></code></pre></div></li><li><p>OpenAI 官方網站的範例</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> openai
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>start_sequence <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>A:&#34;</span>
</span></span><span style=display:flex><span>restart_sequence <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n\n</span><span style=color:#e6db74>Q: &#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>response <span style=color:#f92672>=</span> openai<span style=color:#f92672>.</span>Completion<span style=color:#f92672>.</span>create(
</span></span><span style=display:flex><span>  model<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;&lt;MODEL-NAME&gt;&#34;</span>,
</span></span><span style=display:flex><span>  prompt<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;...&#34;</span>,
</span></span><span style=display:flex><span>  temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  max_tokens<span style=color:#f92672>=</span><span style=color:#ae81ff>100</span>,
</span></span><span style=display:flex><span>  top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>  frequency_penalty<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  presence_penalty<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>  stop<span style=color:#f92672>=</span>[<span style=color:#e6db74>&#34;</span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>]
</span></span><span style=display:flex><span>)
</span></span></code></pre></div></li></ul><p>看起來只需要 <code>OPENAI_API_KEY</code> 就可以了.</p></li><li><p>回到 Azure Cognitive service 畫面, 點選 OpenAI 設定主畫面左方的選單 <code>Keys and Endpoint</code>. 將 Key1 的值複製作為 <code>OPENAI_API_KEY</code>
<img src=/images/2023/2023-01/2023-01-11/09.png alt></p></li><li><p>這次來試試 <code>code-davinci-002</code> 吧!</p><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-python data-lang=python><span style=display:flex><span><span style=color:#f92672>import</span> os
</span></span><span style=display:flex><span><span style=color:#f92672>import</span> openai
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_type <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;azure&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_base <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;https://&lt;ENDPOIND-NAME&gt;.openai.azure.com/&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_version <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;2022-06-01-preview&#34;</span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>api_key <span style=color:#f92672>=</span> os<span style=color:#f92672>.</span>getenv(<span style=color:#e6db74>&#34;OPENAI_API_KEY&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>prompt <span style=color:#f92672>=</span> <span style=color:#e6db74>&#34;&#34;&#34;Answer the question as truthfully as possible using the provided text, and if the answer is not contained within the text below, say &#34;I don&#39;t know&#34;
</span></span></span><span style=display:flex><span><span style=color:#e6db74>
</span></span></span><span style=display:flex><span><span style=color:#e6db74>Q: 幫我產生 ssh tunnel 的 bash script
</span></span></span><span style=display:flex><span><span style=color:#e6db74>A:&#34;&#34;&#34;</span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>openai<span style=color:#f92672>.</span>Completion<span style=color:#f92672>.</span>create(
</span></span><span style=display:flex><span>    engine<span style=color:#f92672>=</span><span style=color:#e6db74>&#34;code-davinci-002&#34;</span>,
</span></span><span style=display:flex><span>    prompt<span style=color:#f92672>=</span>prompt,
</span></span><span style=display:flex><span>    temperature<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    max_tokens<span style=color:#f92672>=</span><span style=color:#ae81ff>300</span>,
</span></span><span style=display:flex><span>    top_p<span style=color:#f92672>=</span><span style=color:#ae81ff>1</span>,
</span></span><span style=display:flex><span>    frequency_penalty<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    presence_penalty<span style=color:#f92672>=</span><span style=color:#ae81ff>0</span>,
</span></span><span style=display:flex><span>    model<span style=color:#f92672>=</span>COMPLETIONS_MODEL
</span></span><span style=display:flex><span>)[<span style=color:#e6db74>&#34;choices&#34;</span>][<span style=color:#ae81ff>0</span>][<span style=color:#e6db74>&#34;text&#34;</span>]<span style=color:#f92672>.</span>strip(<span style=color:#e6db74>&#34; </span><span style=color:#ae81ff>\n</span><span style=color:#e6db74>&#34;</span>)    
</span></span></code></pre></div><p>某種程度也算對&mldr;
<img src=/images/2023/2023-01/2023-01-11/10.png alt></p></li></ol></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=https://jimmyliao.net/zh/tags/azure/>Azure</a>
<a href=https://jimmyliao.net/zh/tags/openai/>OpenAI</a></div></div></div></article></div><div id=comments-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//jimmyliao.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><footer><div class=container><div class=recent-posts><strong>Latest posts</strong><ul><li><a href=https://jimmyliao.net/zh/article/2023/2023-06/2023-06-20-aoai-on-your-data/>在 Azure OpenAI Studio 使用你自己的資料集</a></li><li><a href=https://jimmyliao.net/zh/article/2023/2023-06/2023-06-17-dev-llm/>解放大型語言模型的商業應用 - 概念</a></li><li><a href=https://jimmyliao.net/zh/article/2023/2023-04/2023-04-30-azure-redis-client/>使用 Redis Client - RedisInsight 管理 Azure Redis Cache</a></li><li><a href=https://jimmyliao.net/zh/article/2023/2023-03/2023-03-29-azure-lang-studio-ner-gpt/>在 Azure Language Studio 使用 GPT 模型加速 Labeling 工作</a></li><li><a href=https://jimmyliao.net/zh/article/2023/2023-03/2023-03-14-hugo-theme-bilberry/>更換 Hugo 主題</a></li><li><a href=https://jimmyliao.net/zh/article/2023/2023-02/2023-02-24-bingchat/>New Bing / Bing Chat 原來可以這樣用</a></li><li><a href=https://jimmyliao.net/zh/article/2023/2023-02/2023-02-16-aoai-training-module/>Azure OpenAI Part 7: Azure 學習模組 OpenAI 服務簡介</a></li></ul></div><div class=categories><a href=https://jimmyliao.net/zh/categories/><strong>Categories</strong></a><ul><li><a href=https://jimmyliao.net/zh/categories/azure/>Azure (14)</a></li><li><a href=https://jimmyliao.net/zh/categories/openai/>OpenAI (9)</a></li><li><a href=https://jimmyliao.net/zh/categories/running/>Running (5)</a></li><li><a href=https://jimmyliao.net/zh/categories/windows/>Windows (5)</a></li><li><a href=https://jimmyliao.net/zh/categories/blog/>Blog (4)</a></li><li><a href=https://jimmyliao.net/zh/categories/hexo/>Hexo (2)</a></li><li><a href=https://jimmyliao.net/zh/categories/kubernetes/>Kubernetes (2)</a></li></ul></div><div class=right><div class=external-profiles><strong>Social media</strong>
<a href=https://www.linkedin.com/in/jimmyliao/ target=_blank rel><em class="fab fa-linkedin"></em></a>
<a href=https://twitter.com/jimmyliao target=_blank rel><em class="fab fa-twitter"></em></a>
<a href=https://github.com/jimmyliao target=_blank rel=me><em class="fab fa-github"></em></a>
<a href=https://fb.me/sjliao target=_blank rel><em class="fab fa-facebook"></em></a></div><div class=languages><strong>Other languages</strong>
<a href=/>en</a>
<a href=/zh/article/2023/2023-01/2023-01-11-azure-openai-code/ class=active>zh</a></div><div class=archive><a href=https://jimmyliao.net/zh/archive/><strong>Archive</strong></a></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=https://github.com/jimmyliao target=_blank>&copy;
2023
by JimmyLiao</a></div><div class=author><a href=https://github.com/Lednerb/bilberry-hugo-theme target=_blank>Bilberry Hugo Theme</a></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z8GF80P8LB"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z8GF80P8LB",{anonymize_ip:!1})}</script><script src=https://jimmyliao.net/theme.js></script><div id=activate-algolia-search class=hidden><input type=hidden id=algolia-search-appId value=45CEN6X6AT>
<input type=hidden id=algolia-search-apiKey value=16030625f1a4d0dd3b8aefd794fd4cf1>
<input type=hidden id=algolia-search-indexName value=bilberry-hugo-theme>
<input type=hidden id=algolia-search-noSearchResults value="Nothing found.">
<input type=hidden id=algolia-search-currentLanguageOnly></div></body></html>