<!doctype html><html itemscope itemtype=https://schema.org/WebPage class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=siteBaseUrl content="https://jimmyliao.net"><meta name=author content="JimmyLiao"><meta name=description content="JimmyLiao Notes Blog"><meta name=keywords content="jimmyliao,personal,runner,fullstack,cloud,mobile,architect"><meta name=generator content="Hugo 0.119.0"><title>Cloud-Native Observability Series, Part 1: How to monitor PrimeHub 1-Click Install with Portainer | JimmyLiao</title><meta itemprop=name content="Cloud-Native Observability Series, Part 1: How to monitor PrimeHub 1-Click Install with Portainer"><meta itemprop=description content="loud-Native Observability Series: How to monitor PrimeHub 1-Click Install with Portainer"><meta property="og:site_name" content="JimmyLiao"><meta property="og:title" content="Cloud-Native Observability Series, Part 1: How to monitor PrimeHub 1-Click Install with Portainer"><meta property="og:description" content="loud-Native Observability Series: How to monitor PrimeHub 1-Click Install with Portainer"><meta property="og:type" content="article"><meta property="og:url" content="https://jimmyliao.net/article/2021/2021-11/2021-11-06-portainer-oneclick/"><meta property="article:section" content="article"><meta property="article:published_time" content="2021-11-06T10:25:55+08:00"><meta property="article:modified_time" content="2021-11-06T10:25:55+08:00"><script src=/modernizr-simple.js></script>
<link href=/article/2021/2021-11/2021-11-06-portainer-oneclick/ rel=alternate type=application/rss+xml title=JimmyLiao><link href=/article/2021/2021-11/2021-11-06-portainer-oneclick/ rel=feed type=application/rss+xml title=JimmyLiao><link rel=canonical href=https://jimmyliao.net/article/2021/2021-11/2021-11-06-portainer-oneclick/><link rel=stylesheet href=https://jimmyliao.net/theme.css></head><body class=bilberry-hugo-theme><nav><div class=container><ul class=topnav><li><a href=https://jimmyliao.net/about/>About</a></li></ul><div id=search-box class=search><i class="fas fa-search"></i>
<input id=search type=text placeholder="Search ..."></div></div></nav><header><div class=container><div class=logo><a href=/ class=logo><img src=/images/fb_share.jpg alt>
<span class=overlay><i class="fa fa-home"></i></span></a></div><div class=titles><h3 class=title><a href=/>JimmyLiao</a></h3><span class=subtitle>JimmyLiao Notes: Developer, Runner, Thinker</span></div><div class=languages><a href=/article/2021/2021-11/2021-11-06-portainer-oneclick/ class=active>en</a>
<a href=/zh/>zh</a></div><div class=toggler><i class="fa fa-bars" aria-hidden=true></i></div></div></header><div class="main container"><div class="article-wrapper u-cf single"><a class=bubble href=https://jimmyliao.net/article/2021/2021-11/2021-11-06-portainer-oneclick/><i class="fas fa-fw fa-pencil-alt"></i></a><article class="default article"><div class=content><h1 class=article-title><a href=https://jimmyliao.net/article/2021/2021-11/2021-11-06-portainer-oneclick/>Cloud-Native Observability Series, Part 1: How to monitor PrimeHub 1-Click Install with Portainer</a></h1><div class=meta><span class="date moment">2021-11-06</span>
<span class=categories><a href=https://jimmyliao.net/categories/kubernetes/>Kubernetes</a>
<a href=https://jimmyliao.net/categories/cloudnative/>CloudNative</a>
<a href=https://jimmyliao.net/categories/observability/>Observability</a>
<a href=https://jimmyliao.net/categories/primehub/>PrimeHub</a>
<a href=https://jimmyliao.net/categories/portainer/>Portainer</a></span></div><p><strong>How to monitor the PrimeHub 1-Click Install with Portainer</strong></p><p>The first step after setting up the PrimeHub 1-Click onto Kubernetes is to find the solutions for observability, including monitoring, logging, and tracing. This article shows the easy way to build it.</p><p>Previous I introduce <a href=https://jimmyliao.net/post/2021-09-01-k9s-microk8s/>K9S</a> to monitor the Clusters with <code>~/.kube/config</code> switch, this post shows the easy way to build with web-based monitoring.</p><ol><li><p>Follow the <a href=https://docs.portainer.io/v/ce-2.9/start/install>Portainer CE Installation</a> to setup onto your desktop, or the lab environment, as long as you have the Docker runtime.</p></li><li><p>There are two <a href=https://docs.portainer.io/v/ce-2.9/admin/environments/add/kubernetes>deploy methods</a> onto your clusters: NodePort and Load Balancer. Here I use Load Balancer:</p></li></ol><pre tabindex=0><code>$ curl -L https://downloads.portainer.io/portainer-agent-ce29-k8s-lb.yaml \
  -o portainer-agent-k8s.yaml; kubectl apply -f portainer-agent-k8s.yaml

  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                Dload  Upload   Total   Spent    Left  Speed
100  1593  100  1593    0     0   2482      0 --:--:-- --:--:-- --:--:--  2532
namespace/portainer created
serviceaccount/portainer-sa-clusteradmin created
clusterrolebinding.rbac.authorization.k8s.io/portainer-crb-clusteradmin created
service/portainer-agent created
service/portainer-agent-headless created
deployment.apps/portainer-agent created
</code></pre><ol start=3><li>Check the deploying</li></ol><pre tabindex=0><code>$ kubectl get svc -A

ingress-nginx   nginx-ingress-ingress-nginx-controller       LoadBalancer   
  172.20.239.95 xxxx-xxxxxxxxxxxxxxxx.elb.us-east-1.amazonaws.com   
  80:31297/TCP,443:31105/TCP,2222:30602/TCP   35m
...
portainer       portainer-agent                              LoadBalancer   
  172.20.127.46    xxx-1518996078.us-east-1.elb.amazonaws.com         
  9001:30434/TCP                              10s
</code></pre><p>and this
<img src=/images/2021-11-06-portainer-01.png alt></p><ol start=4><li><p>Add the environment: check the <code>EXTERNAL-IP</code> from the step 3. Then fill the <code>Public IP</code> field with same EXTERNAL-IP; the <code>Environment URL</code> is <code>Public IP</code>:9001</p></li><li><p>(Optional) If you want to enable the metrics server of AWS, follow this <a href=https://docs.aws.amazon.com/eks/latest/userguide/metrics-server.html>guide</a> to install onto your cluster.
<img src=/images/2021-11-06-portainer-02.png alt></p></li></ol><pre tabindex=0><code>$ kubectl apply -f \
https://github.com/kubernetes-sigs/metrics-server/releases/latest/download/components.yaml

serviceaccount/metrics-server created
clusterrole.rbac.authorization.k8s.io/system:aggregated-metrics-reader created
clusterrole.rbac.authorization.k8s.io/system:metrics-server created
rolebinding.rbac.authorization.k8s.io/metrics-server-auth-reader created
clusterrolebinding.rbac.authorization.k8s.io/metrics-server:system:auth-delegator created
clusterrolebinding.rbac.authorization.k8s.io/system:metrics-server created
service/metrics-server created
deployment.apps/metrics-server created
apiservice.apiregistration.k8s.io/v1beta1.metrics.k8s.io created
</code></pre><pre tabindex=0><code>$ kubectl get deployment metrics-server -n kube-system

NAME             READY   UP-TO-DATE   AVAILABLE   AGE
metrics-server   1/1     1            1           38s
</code></pre><ol start=6><li>Finally to see it on the Portainer Console.
<img src=/images/2021-11-06-portainer-03.png alt></li></ol><p><img src=/images/2021-11-06-portainer-04.png alt></p><p><img src=/images/2021-11-06-portainer-05.png alt></p><p>Enjoy!</p></div><div class=footer><div class=tags><i class="fa fa-tags"></i><div class=links><a href=https://jimmyliao.net/tags/kubernetes/>Kubernetes</a>
<a href=https://jimmyliao.net/tags/cloudnative/>CloudNative</a>
<a href=https://jimmyliao.net/tags/observability/>Observability</a>
<a href=https://jimmyliao.net/tags/primehub/>PrimeHub</a>
<a href=https://jimmyliao.net/tags/portainer/>Portainer</a></div></div></div></article></div><div id=comments-container><div id=disqus_thread></div><script type=application/javascript>window.disqus_config=function(){},function(){if(["localhost","127.0.0.1"].indexOf(window.location.hostname)!=-1){document.getElementById("disqus_thread").innerHTML="Disqus comments not available by default when the website is previewed locally.";return}var t=document,e=t.createElement("script");e.async=!0,e.src="//jimmyliao.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)}()</script><noscript>Please enable JavaScript to view the <a href=https://disqus.com/?ref_noscript>comments powered by Disqus.</a></noscript><a href=https://disqus.com class=dsq-brlink>comments powered by <span class=logo-disqus>Disqus</span></a></div></div><footer><div class=container><div class=recent-posts><strong>Latest posts</strong><ul><li><a href=https://jimmyliao.net/article/2023/2023-03/2023-03-29-azure-lang-studio-ner-gpt/>Using the GPT model in Azure Language Studio to speed up Labelling</a></li><li><a href=https://jimmyliao.net/article/2023/2023-03/2023-03-14-hugo-theme-bilberry/>Change the Hugo theme to BilBerry</a></li><li><a href=https://jimmyliao.net/article/2022/2022-07/2022-07-06-microsoft/>JimmyLiao.README (2022/07) - Cloud Solution Architect @ Microsoft</a></li><li><a href=https://jimmyliao.net/article/2022/2022-05/2022-05-22-infuseai/>JimmyLiao.README (2022/05) - GoodBye InfuseAI</a></li><li><a href=https://jimmyliao.net/article/2022/2022-04/2022-04-24-hugo-regenerate-token/>Regenerate token for GitHub Page Actions</a></li><li><a href=https://jimmyliao.net/article/2022/2022-04/2022-04-17-basketball/>大考大玩</a></li><li><a href=https://jimmyliao.net/article/2022/2022-04/2022-04-22-ubuntu-22.04/>Learn english from Ubuntu 22.04 Codename</a></li></ul></div><div class=categories><a href=https://jimmyliao.net/categories/><strong>Categories</strong></a><ul><li><a href=https://jimmyliao.net/categories/blog/>Blog (8)</a></li><li><a href=https://jimmyliao.net/categories/markdown/>Markdown (6)</a></li><li><a href=https://jimmyliao.net/categories/about/>About (4)</a></li><li><a href=https://jimmyliao.net/categories/kubernetes/>Kubernetes (3)</a></li><li><a href=https://jimmyliao.net/categories/primehub/>PrimeHub (3)</a></li><li><a href=https://jimmyliao.net/categories/ubuntu/>Ubuntu (3)</a></li><li><a href=https://jimmyliao.net/categories/octopress/>Octopress (2)</a></li></ul></div><div class=right><div class=external-profiles><strong>Social media</strong>
<a href=https://www.linkedin.com/in/jimmyliao/ target=_blank rel><em class="fab fa-linkedin"></em></a>
<a href=https://twitter.com/jimmyliao target=_blank rel><em class="fab fa-twitter"></em></a>
<a href=https://github.com/jimmyliao target=_blank rel=me><em class="fab fa-github"></em></a>
<a href=https://fb.me/sjliao target=_blank rel><em class="fab fa-facebook"></em></a></div><div class=languages><strong>Other languages</strong>
<a href=/article/2021/2021-11/2021-11-06-portainer-oneclick/ class=active>en</a>
<a href=/zh/>zh</a></div><div class=archive><a href=https://jimmyliao.net/archive/><strong>Archive</strong></a></div></div></div></footer><div class=credits><div class=container><div class=copyright><a href=https://github.com/jimmyliao target=_blank>&copy;
2023
by JimmyLiao</a></div><div class=author><a href=https://github.com/Lednerb/bilberry-hugo-theme target=_blank>Bilberry Hugo Theme</a></div></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-Z8GF80P8LB"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-Z8GF80P8LB",{anonymize_ip:!1})}</script><script src=https://jimmyliao.net/theme.js></script><div id=activate-algolia-search class=hidden><input type=hidden id=algolia-search-appId value=45CEN6X6AT>
<input type=hidden id=algolia-search-apiKey value=16030625f1a4d0dd3b8aefd794fd4cf1>
<input type=hidden id=algolia-search-indexName value=bilberry-hugo-theme>
<input type=hidden id=algolia-search-noSearchResults value="Nothing found.">
<input type=hidden id=algolia-search-currentLanguageOnly></div></body></html>